#!/usr/bin/expect -f
set timeout 30

# Load secrets
if {[file exists "deploy_secrets.exp"]} {
    source "deploy_secrets.exp"
} else {
    puts "Error: deploy_secrets.exp not found!"
    exit 1
}

# Command to run
set cmd "cd /root/twitter-hot && docker compose ps && echo '--- LOGS ---' && docker compose logs --tail=20 backend"

spawn ssh -o StrictHostKeyChecking=no $user@$host $cmd
expect {
    "password:" {
        send "$password\r"
        exp_continue
    }
    eof
}
